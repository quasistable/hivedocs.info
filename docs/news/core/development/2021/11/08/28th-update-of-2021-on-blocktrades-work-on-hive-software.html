<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/assets/images/sticker.png" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>28th update of 2021 on BlockTrades work on Hive software | Hive Chain Documentation</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="28th update of 2021 on BlockTrades work on Hive software" />
<meta name="author" content="blocktrades" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Below is a list of Hive-related programming issues worked on by BlockTrades team during last week …" />
<meta property="og:description" content="Below is a list of Hive-related programming issues worked on by BlockTrades team during last week …" />
<link rel="canonical" href="https://hive.blog/hive-139531/@blocktrades/28th-update-of-2021-on-blocktrades-work-on-hive-software" />
<meta property="og:url" content="https://hive.blog/hive-139531/@blocktrades/28th-update-of-2021-on-blocktrades-work-on-hive-software" />
<meta property="og:site_name" content="Hive Chain Documentation" />
<meta property="og:image" content="https://images.hive.blog/DQmSihw8Kz4U7TuCQa98DDdCzqbqPFRumuVWAbareiYZW1Z/blocktrades%20update.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-08T16:27:15-08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://images.hive.blog/DQmSihw8Kz4U7TuCQa98DDdCzqbqPFRumuVWAbareiYZW1Z/blocktrades%20update.png" />
<meta property="twitter:title" content="28th update of 2021 on BlockTrades work on Hive software" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"blocktrades"},"description":"Below is a list of Hive-related programming issues worked on by BlockTrades team during last week …","url":"https://hive.blog/hive-139531/@blocktrades/28th-update-of-2021-on-blocktrades-work-on-hive-software","mainEntityOfPage":{"@type":"WebPage","@id":"https://hive.blog/hive-139531/@blocktrades/28th-update-of-2021-on-blocktrades-work-on-hive-software"},"image":"https://images.hive.blog/DQmSihw8Kz4U7TuCQa98DDdCzqbqPFRumuVWAbareiYZW1Z/blocktrades%20update.png","headline":"28th update of 2021 on BlockTrades work on Hive software","dateModified":"2021-11-08T16:27:15-08:00","datePublished":"2021-11-08T16:27:15-08:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://hivedocs.info/feed.xml" title="Hive Chain Documentation" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-161692811-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  
  <!-- jQuery Modal -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" integrity="sha256-iM4Yzi/zLj/IshPWMC1IluRxTtRjMqjPGd97TZ9yYpU=" crossorigin="anonymous"></script>
  <script src='https://unpkg.com/steem-content-renderer'></script>
  <script>
    (function () {
      if (Turbolinks.supported) {
        Turbolinks.setProgressBarDelay(500);
      }
    })();
  </script>
  <script src="/assets/javascript/universal-bridge-against-phishing.js"></script>
  <script src="/assets/javascript/lazysizes.min.js" async=""></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Cousine|Inconsolata" rel="stylesheet">
  <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png">
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Hive Chain Documentation</a>

      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/news/">News</a><a class="page-link" href="/howto/">How To</a><a class="page-link" href="/links/">Useful Links</a><a class="page-link" href="/authors/">Authors</a><!-- HTML elements for search -->
          <input type="text" id="search-input" placeholder="Search" />
          
          <ul id="results-container"></ul>

          <script src="/assets/javascript/search.js"></script>
          <script>
            var sjs = SimpleJekyllSearch({
              searchInput: document.getElementById('search-input'),
              resultsContainer: document.getElementById('results-container'),
              json: '/search.json'
            })
          </script>
          <!-- <form style="float: right;" class="form-inline" method="get" action="http://www.google.com/search">
            <input type="hidden" name="sitesearch" value="hivedocs.info" />
            <input type="text" name="q" maxlength="255" placeholder="Search" />
          </form> -->
          
          <!-- <a href="#" onclick="try { $('#authors-container').slideToggle(); } catch { document.getElementById('authors-container').style.display = 'block'; }; return false;">Authors &#187;</a>
          <a href="#" onclick="try { $('#topics-container').slideToggle(); } catch { document.getElementById('topics-container').style.display = 'block'; }; return false;">Topics &#187;</a> -->
          
          <a href="#topics-container" rel="modal:open">Topics &#187;</a>
          
          <div id="topics-container" class="modal">
            <h3>Topics</h3>
            <ul><li><a class="page-link" href="/account-recovery/"><nobr>Account Recovery</nobr></a></li><li><a class="page-link" href="/core-development/"><nobr>Core Development</nobr></a></li><li><a class="page-link" href="/dapps/"><nobr>Dapps</nobr></a></li><li><a class="page-link" href="/docker/"><nobr>Docker</nobr></a></li><li><a class="page-link" href="/hardfork/"><nobr>Hardfork</nobr></a></li><li><a class="page-link" href="/hivemind/"><nobr>Hivemind</nobr></a></li><li><a class="page-link" href="/javascript/"><nobr>Javascript</nobr></a></li><li><a class="page-link" href="/multisig/"><nobr>Multisig</nobr></a></li><li><a class="page-link" href="/python/"><nobr>Python</nobr></a></li><li><a class="page-link" href="/ruby/"><nobr>Ruby</nobr></a></li><li><a class="page-link" href="/testnet/"><nobr>Testnet</nobr></a></li><li><a class="page-link" href="/tools/"><nobr>Tools</nobr></a></li><li><a class="page-link" href="/witness/"><nobr>Witness</nobr></a></li></ul>
          </div>
        </div>
      </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <div class="pull-right well">
      <img src="https://images.hive.blog/u/blocktrades/avatar" width="128" height="128" class="lazyload" />
    </div>
    
    <h1 class="post-title p-name" itemprop="name headline">28th update of 2021 on BlockTrades work on Hive software</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-11-08T16:27:15-08:00" itemprop="datePublished">Nov 8, 2021
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">
          <a href="/authors/#author-blocktrades">blocktrades</a>
        </span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div id="content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software">![blocktrades update.png](https://images.hive.blog/DQmSihw8Kz4U7TuCQa98DDdCzqbqPFRumuVWAbareiYZW1Z/blocktrades%20update.png)
Below is a list of some of the Hive-related programming issues worked on by BlockTrades team during the past work period:

# Hived work (blockchain node software)

### Updating RC cost calculation code

We continued to analyze the resource credits code. We’ve written some code to dump rc costs during replay of the blockchain and created some graphs to analyze how the rc resource pools change over the blockchain’s operational history. Our most significant finding so far is that the execution time costs are totally inaccurate right now, largely because signature verification time wasn’t accounted for at all.

To get better estimates of real world execution time costs, we’re probably going to create a tool to measure execution times for various operations during replay as a starting point for updating them to accurate values, with a separate cost calculation that accounts for signature costs based on number of signatures used by the transaction containing the operations.

### Testing via new “mirror net” technology identified a new bug (now fixed)

As mentioned a while back, we’ve been developing a tool for taking an existing block_log (e.g. a block_log from the mainnet) as a starting point for launching a testnet that more closely matches the configuration of the mainnet. This technology is conceptually similar to the idea behind the older tinman/gatlin code, but is designed for higher performance.

The new mirror net code is already proving it’s worth, as we found a bug in the hived code while testing the mirror net code, whereby the reward balance could go negative. For more on this bug, see the fix and associated issue: https://gitlab.syncad.com/hive/hive/-/merge_requests/306

In the longer term, we’ll be integrating this technology into our build-and-test system (continuous integration system) for various advanced test scenarios.

### Finished testing and merged in Command-line interface (CLI) wallet improvements to develop branch

Complete improvements for offline use of the CLI wallet:
https://gitlab.syncad.com/hive/hive/-/merge_requests/265
Add default value to the server-rpc-endpoint option:
https://gitlab.syncad.com/hive/hive/-/merge_requests/273

Other hived-related work:
* Finished testing and merged in fixes for sql_serializer and account history plugins: https://gitlab.syncad.com/hive/hive/-/merge_requests/289
https://gitlab.syncad.com/hive/hive/-/merge_requests/294
* Merged in changes for HBD limits for HF26: https://gitlab.syncad.com/hive/hive/-/merge_requests/297
* Removed obsolete option to `SKIP_BY_TX_ID` from compile options: https://gitlab.syncad.com/hive/hive/-/merge_requests/301

* Fix for problem with faketime library on some platforms: https://gitlab.syncad.com/hive/hive/-/merge_requests/303
* Updated some API pattern tests based on bug fixes: https://gitlab.syncad.com/hive/hive/-/merge_requests/299
* Improved testtools robustness when there is a temporary communication interruption to nodes being tested:
https://gitlab.syncad.com/hive/hive/-/merge_requests/302
* Updated to use newer clang-tidy linter (now uses the default one on Ubuntu 20):
https://gitlab.syncad.com/hive/hive/-/merge_requests/300
* Compile all targets with boost &gt; 1.70 available on Ubuntu 20.04: https://gitlab.syncad.com/hive/hive/-/merge_requests/307

# Hive Application Framework: framework for building robust and scalable Hive apps

A lot of our work during the last period has continued to focus on app framework development and testing. 

We continued to work on code cleanup associated with the new HAF repo (this is the new repo mentioned last week that contains the components that are common to all HAF-based applications that was created to better manage version compatibility among HAF components and prerequisite applications such as hived). 

A lot of documentation was added and/or updated, more testing by 3rd party testers (like me) to ensure instructions are clear and accurate on “clean systems” (i.e. not the developer’s computer), fixes were made for build and test compatibility on both Ubuntu 18 and 20 (although Ubuntu 20 is still the recommended platform for any HAF-related development), etc.

A new API call, `hive.connect`, was added which handles database inconsistencies that can potentially arise if the connection between hived and the postgres server is broken, allowing serializing to be smoothly resumed. https://gitlab.syncad.com/hive/haf/-/merge_requests/13


We also added system tests for the sql_serializer to the new HAF repo: https://gitlab.syncad.com/hive/haf/-/merge_requests/17
With this addition, we have a full test suite for all the components contained in the HAF repo.



### Optimizing HAF-based account history app (Hafah)

This week we continued to do performance testing and optimization of hafah. 

We added a library that allows us to track memory usage, and the latest incarnation with memory optimizations was able to sync all the way to the headblock using only 4GB of virtual memory while configured to use 7 threads for sending/receiving data. Previously using this many threads required nearly 128GB of memory, so it was a useful improvement.

Further improvements were also made to the sync process, which at least in the 5M block scenario that was tested, reduced sync time from 280s down to 180s. This improvement still needs to be benchmarked with a full sync to headblock, but it is likely we'll see similar improvements in performance for a full sync.

### Benchmark multi-threaded jsonrpc server for HAF apps (using hafah as our “test” app)

Preliminary benchmarking using a multi-threaded jsonrpc server showed 2-3x speed improvement in api performance for an experimental version of hafah synced to 5M blocks (2-3x performance measured relative to the original single-threaded jsonrpc server), but we still need to repeat these benchmarks with a version of hafah synced to the current head block.

# Hivemind (social media middleware app used by social media frontends like hive.blog)

As mentioned last week, there was a bug detected during our production testing with some notifications showing as from 1970. 

We’ve fixed this bug and the new version with this fix is now being tested on production. Assuming no problems, we’ll tag an official release with the bug fix in the next couple of days.

# Work in progress and upcoming work

* In progress: experiment with generating the “impacted accounts” table directly from sql_serializer to see if it is faster than our current method where hafah generates this data on demand as it needs it. This task will also require creating a simplified form of hafah. In fact, the new hafah would be so simplified on the indexer side, that we’re considering adding additional functionality to it, to allow it to maintain a  per-block account balance history so that there is something that does real work in the indexing portion of the code. This would also be useful as a template for future work on 2nd-layer tokens.
* Release a final official version of hivemind with postgres 10 support, then update hivemind CI to start testing using postgres 12 instead of 10.
* Run tests to compare results between account history plugin and HAF-based account history apps.
* Finish setup of continuous integration testing for HAF account history app.
* Finish conversion of hivemind to HAF-based app. Once we’re further along with HAF-based hivemind, we’ll test it using the fork-inducing tool.
* Fix rc cost estimations for execution time as described in hived section of this post.
* Deploy new version of condenser that displays RC level for signed-in account.</div>
<script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>

<script src="https://unpkg.com/steem-content-renderer"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/hive-content-renderer/dist/hive-content-renderer.min.js"></script> -->
<script>
  $(document).ready(function() {
    try {
      const renderer = new SteemContentRenderer.DefaultRenderer({
      // const renderer = new HiveContentRenderer({
        baseUrl: "https://hive.blog/",
        breaks: true,
        skipSanitization: false,
        allowInsecureScriptTags: false,
        addNofollowToLinks: true,
        doNotShowImages: false,
        ipfsPrefix: "",
        assetsWidth: 640,
        assetsHeight: 480,
        imageProxyFn: (url) => url,
        usertagUrlFn: (account) => "/@blocktrades",
        hashtagUrlFn: (hashtag) => "/28th-update-of-2021-on-blocktrades-work-on-hive-software",
        isLinkSafeFn: (url) => true,
      });
      
      const inputElem = $('#content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software').html();
      const outputElem = $('#content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software');
      const output = renderer.render(inputElem);
      
      outputElem.html(output);
    } catch(e) {
      console.log(e);
    }
  });
</script>

<style>
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software {
    padding: 0 3rem;
    color: #444444;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 1.8;
    text-shadow: 0 1px 0 #ffffff;
    padding: 0.5rem;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software code {
    background: white;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software a {
    border-bottom: 1px solid #444444; color: #444444; text-decoration: none;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software a:hover {
    border-bottom: 0;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software h1 {
    font-size: 2.2em;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software h2, h3, h4, h5 {
    margin-bottom: 0;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software header small {
    color: #999;
    font-size: 50%;
  }
  #content-blocktrades-28th-update-of-2021-on-blocktrades-work-on-hive-software img {
    max-width: 100%;
  }
</style>

<hr />

<p>
  See: <a href="https://hive.blog/hive-139531/@blocktrades/28th-update-of-2021-on-blocktrades-work-on-hive-software">28th update of 2021 on BlockTrades work on Hive software</a>
  by
  <a href="https://hive.blog/@blocktrades">@blocktrades</a>
</p>


  </div><a class="u-url" href="/news/core/development/2021/11/08/28th-update-of-2021-on-blocktrades-work-on-hive-software.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><a rel="author" href="/">Hive Chain Documentation</a></h2>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">site curated by: @inertia</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Your resource for various levels of Hive Documentation.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
