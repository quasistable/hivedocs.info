<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/assets/images/sticker.png" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>How to use a coldcard MK3 to derive your new account password from a 24 word seed | Hive Chain Documentation</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="How to use a coldcard MK3 to derive your new account password from a 24 word seed" />
<meta name="author" content="holger80" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="When you have stored your bitcoin seed (consisting normally of 24 words) in metal, it would be great if you could use this also to store your Hive password." />
<meta property="og:description" content="When you have stored your bitcoin seed (consisting normally of 24 words) in metal, it would be great if you could use this also to store your Hive password." />
<link rel="canonical" href="https://hive.blog/hive-139531/@holger80/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed" />
<meta property="og:url" content="https://hive.blog/hive-139531/@holger80/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed" />
<meta property="og:site_name" content="Hive Chain Documentation" />
<meta property="og:image" content="https://images.hive.blog/DQmWagwVQs2GsJFQMMFpQCbLFSWxKS5jmDK5WYsfNAC6tkq/New%20Password" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-05T15:10:18-08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://images.hive.blog/DQmWagwVQs2GsJFQMMFpQCbLFSWxKS5jmDK5WYsfNAC6tkq/New%20Password" />
<meta property="twitter:title" content="How to use a coldcard MK3 to derive your new account password from a 24 word seed" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"holger80"},"description":"When you have stored your bitcoin seed (consisting normally of 24 words) in metal, it would be great if you could use this also to store your Hive password.","url":"https://hive.blog/hive-139531/@holger80/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed","mainEntityOfPage":{"@type":"WebPage","@id":"https://hive.blog/hive-139531/@holger80/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed"},"image":"https://images.hive.blog/DQmWagwVQs2GsJFQMMFpQCbLFSWxKS5jmDK5WYsfNAC6tkq/New%20Password","headline":"How to use a coldcard MK3 to derive your new account password from a 24 word seed","dateModified":"2020-12-05T15:10:18-08:00","datePublished":"2020-12-05T15:10:18-08:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://hivedocs.info/feed.xml" title="Hive Chain Documentation" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-161692811-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  
  <!-- jQuery Modal -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" integrity="sha256-iM4Yzi/zLj/IshPWMC1IluRxTtRjMqjPGd97TZ9yYpU=" crossorigin="anonymous"></script>
  <script src='https://unpkg.com/steem-content-renderer'></script>
  <script>
    (function () {
      if (Turbolinks.supported) {
        Turbolinks.setProgressBarDelay(500);
      }
    })();
  </script>
  <script src="/assets/javascript/universal-bridge-against-phishing.js"></script>
  <script src="/assets/javascript/lazysizes.min.js" async=""></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Cousine|Inconsolata" rel="stylesheet">
  <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png">
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Hive Chain Documentation</a>

      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/news/">News</a><a class="page-link" href="/howto/">How To</a><a class="page-link" href="/links/">Useful Links</a><a class="page-link" href="/authors/">Authors</a><!-- HTML elements for search -->
          <input type="text" id="search-input" placeholder="Search" />
          
          <ul id="results-container"></ul>

          <script src="/assets/javascript/search.js"></script>
          <script>
            var sjs = SimpleJekyllSearch({
              searchInput: document.getElementById('search-input'),
              resultsContainer: document.getElementById('results-container'),
              json: '/search.json'
            })
          </script>
          <!-- <form style="float: right;" class="form-inline" method="get" action="http://www.google.com/search">
            <input type="hidden" name="sitesearch" value="hivedocs.info" />
            <input type="text" name="q" maxlength="255" placeholder="Search" />
          </form> -->
          
          <!-- <a href="#" onclick="try { $('#authors-container').slideToggle(); } catch { document.getElementById('authors-container').style.display = 'block'; }; return false;">Authors &#187;</a>
          <a href="#" onclick="try { $('#topics-container').slideToggle(); } catch { document.getElementById('topics-container').style.display = 'block'; }; return false;">Topics &#187;</a> -->
          
          <a href="#topics-container" rel="modal:open">Topics &#187;</a>
          
          <div id="topics-container" class="modal">
            <h3>Topics</h3>
            <ul><li><a class="page-link" href="/account-recovery/"><nobr>Account Recovery</nobr></a></li><li><a class="page-link" href="/core-development/"><nobr>Core Development</nobr></a></li><li><a class="page-link" href="/dapps/"><nobr>Dapps</nobr></a></li><li><a class="page-link" href="/docker/"><nobr>Docker</nobr></a></li><li><a class="page-link" href="/hardfork/"><nobr>Hardfork</nobr></a></li><li><a class="page-link" href="/hivemind/"><nobr>Hivemind</nobr></a></li><li><a class="page-link" href="/javascript/"><nobr>Javascript</nobr></a></li><li><a class="page-link" href="/multisig/"><nobr>Multisig</nobr></a></li><li><a class="page-link" href="/python/"><nobr>Python</nobr></a></li><li><a class="page-link" href="/ruby/"><nobr>Ruby</nobr></a></li><li><a class="page-link" href="/testnet/"><nobr>Testnet</nobr></a></li><li><a class="page-link" href="/tools/"><nobr>Tools</nobr></a></li><li><a class="page-link" href="/witness/"><nobr>Witness</nobr></a></li></ul>
          </div>
        </div>
      </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <div class="pull-right well">
      <img src="https://images.hive.blog/u/holger80/avatar" width="128" height="128" class="lazyload" />
    </div>
    
    <h1 class="post-title p-name" itemprop="name headline">How to use a coldcard MK3 to derive your new account password from a 24 word seed</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-12-05T15:10:18-08:00" itemprop="datePublished">Dec 5, 2020
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">
          <a href="/authors/#author-holger80">holger80</a>
        </span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div id="content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed">
Each hive account has four keys which can be used to sign broadcast operations. As the key name says (owner key, active key, posting key), they have different use cases. Normally, a single password is used to derive these four keys from it. This has the advantage that only one passphrase needs to be securely stored.

I can change my account keys by generating a new password:
![New Password](https://images.hive.blog/DQmWagwVQs2GsJFQMMFpQCbLFSWxKS5jmDK5WYsfNAC6tkq/New%20Password)

You need to `BACK IT UP BY STORING IN YOUR PASSWORD MANAGER OR A TEXT FILE.`, but what happens when your hard drive is failing or your password manager (lost the master password, ...)? You can print it, but what happens in case of a fire or water damage?

## Using your bitcoin seed for Hive
When you have stored your bitcoin seed (consisting normally of 24 words) in metal, it would be great if you could use this also to store your Hive password.

It is possible to use [BIP-85 (Deterministic Entropy From BIP32 Keychains)](https://github.com/bitcoin/bips/blob/master/bip-0085.mediawiki) for creating a new password for a hive account using a coldcard mk3 hardware wallet (As far as I know this is the only device that support BIP85).

![coldcard](https://images.hive.blog/DQmYZebd2XQzeyxR2LhQEuiCmvAZpweC1ywThuBnkmAtHVb/coldcard)


When I use the derived WIF to create a new Password for my Hive account, I do not need to store my Hive keys and Password anymore, as they can be recreated from the securely stored bitcoin seed (I need to remember the used index number, or I need to try all possible numbers from 0 to 9999).

Thus I can increase my account security when I do not store the password and the owner key in my computer.



## How to use the coldcard mk3 to create a new Password for Hive
This guide will use the [coldcard mk3](https://coldcardwallet.com/) which has the necessary bip-85 support and python (beem) for generating and changing the account keys.

### Storing a WIF on a sdcard
At first we use the coldcard to derive a new WIF and store it on a sdcard.


![Go to Advanced](https://images.hive.blog/DQmUJxn6RzUbxNrXMMkP6PnT1UTMQC4kbHe6Ad1PYLiFyqD/Go%20to%20Advanced)
![Then to Derive Entropy](https://images.hive.blog/DQmVjNSAtvVtuiDPnM4u91D8VypYkdhx1UeVsooFzkhSFVs/Then%20to%20Derive%20Entropy)
We need to select WIF:
![Then to WIF](https://images.hive.blog/DQmSn5u2kBPRsf7V5EiM2VrUSdKgS7VDQhkJjJCte8ZDS3f/Then%20to%20WIF)
Select a number you can remember:
![Select a number](https://images.hive.blog/DQmRrywjVhNWgscazDfVV9f1UrmVZKhpU1R9xj6xEjN7DT4/Select%20a%20number)
Store the WIF to the MicroSD:
![Press 1 to store the WIF on the sd card](https://images.hive.blog/DQmQiWagr6YLFoPCjrBBptJqGAhP5GP5ZzbGomEio1xYfAa/Press%201%20to%20store%20the%20WIF%20on%20the%20sd%20card)

## Reading the WIF from the sdcard and change the HIVE keys
We need the following python packages:
```
pip3 install beem
```

The WIF from the coldcard needs firstly converted into a HIVE WIF and then a password is derived by applying `PasswordKey` to it and adding a `P`:

```
from beemgraphenebase.account import PrivateKey, PasswordKey
WIF="xxx" # from coldcard
wif = PrivateKey(WIF)
pk = PasswordKey("", str(wif), role="")
password = 'P' + str(pk.get_private())
print(password)
```
`password` is the new account password that can be set in `https://wallet.hive.blog/@<username>/password`

After changing the account password, the new posting, active and memo key should be stored and the Password and the WIF on the sdcard should be deleted.

Whenever, an account key is getting lost or when the owner key is needed, 
it can be created from the derive WIF which is created by the coldcard.


It is also possible to automate everything. The following script will
* Read the sdcard and extract the WIF
* Create a new Password for the account
* Change the account password by broadcasting `update_account`

```
from beem import Hive
from beemgraphenebase.account import PrivateKey, PasswordKey
import argparse
from prettytable import PrettyTable
import sys
import getpass


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Derives a new password from a coldcard WIF")
    parser.add_argument('wiffile', type=str, nargs='?',
                        help='colcard wif key file to read.')
    parser.add_argument('account', type=str, nargs='?',
                        help='account name.')    
    args = parser.parse_args()
    wiffile = args.wiffile
    account = args.account
    next_var = ""
    wif = ""
    path = ""
    with open(wiffile) as fp: 
        for line in fp:
            if line.strip() == "":
                continue
            if line.strip() == "WIF (privkey):":
                next_var = "wif"
                continue
            elif "Path Used" in line.strip():
                next_var = "path"
                continue
            if next_var == "wif":
                wif = line.strip()
            elif next_var == "path":
                path = line
            next_var = ""
    wif = PrivateKey(wif)
    pk = PasswordKey("", str(wif), role="")
    password = 'P' + str(pk.get_private())
    
    owner_key = PasswordKey(account, password, role="owner")
    owner_pubkey = format(owner_key.get_public_key(), "STM")
    
    active_key = PasswordKey(account, password, role="active")
    active_pubkey = format(active_key.get_public_key(), "STM")
    
    posting_key = PasswordKey(account, password, role="posting")
    posting_pubkey = format(posting_key.get_public_key(), "STM")
    
    memo_key = PasswordKey(account, password, role="memo")
    memo_pubkey = format(memo_key.get_public_key(), "STM")
    
    
    t = PrettyTable(["Key", "Value"])
    t.align = "l"
    t.add_row(["Account", account])
    t.add_row(["Path", path])   
    t.add_row(["New owner pubkey", owner_pubkey])
    t.add_row(["New active pubkey", active_pubkey])   
    t.add_row(["New posting pubkey", posting_pubkey])   
    t.add_row(["New memo pubkey", memo_pubkey])   
    print(t)
    ret = input("Broadcast update_account with new keys? [y/n]")
    if ret in ["y", "yes"]:
        owner_key = getpass.getpass(prompt="current owner key:")
        hive = Hive(keys=[owner_key])
        tx = hive.update_account(account, owner_key=owner_pubkey, active_key=active_pubkey,
                                 posting_key=posting_pubkey, memo_key=memo_pubkey)
        print(tx)
    
    ret = input("Show private keys? [y/n]")
    if ret in ["y", "yes"]:
        t = PrettyTable(["Key", "Value"])
        t.align = "l"
        t.add_row(["active privkey", str(active_key.get_private_key())])   
        t.add_row(["posting privkey", str(posting_key.get_private_key())])   
        t.add_row(["memo privkey", str(memo_key.get_private_key())])
        print(t)
    ret = input("Show owner key and password? [y/n]")
    if ret in ["y", "yes"]:
        t = PrettyTable(["Key", "Value"])
        t.align = "l"
        t.add_row(["owner privkey", str(owner_key.get_private_key())])
        t.add_row(["Password", str(password)])
        print(t)
    del owner_key
    del memo_key
    del posting_key
    del active_key
    del password
```
This needs to be stored as py file (e.g. new_password.py) and can then be called:
```
python3 new_password.py F:\drv-wif-idx0.txt holger80
```
where `F:\drv-wif-idx0.txt` is the path to the exported WIF file.

Deleting the WIF text file on the sdcard needs to be done by hand (remember to store the used index number).

I'm currently adding this also to beempy, the CLI tool in beem.
There is also a second way in creating a new password from a seed using hardware wallet (signing a message), which I'm investigating right now.


___

*If you like what I do, consider casting a vote for me as witness on [Hivesigner](https://hivesigner.com/sign/account-witness-vote?witness=holger80&amp;approve=1) or on [PeakD](https://peakd.com/witnesses)*&lt;/div&gt;
<script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://unpkg.com/steem-content-renderer"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/hive-content-renderer/dist/hive-content-renderer.min.js"></script> -->
<script>
  $(document).ready(function() {
    try {
      const renderer = new SteemContentRenderer.DefaultRenderer({
      // const renderer = new HiveContentRenderer({
        baseUrl: "https://hive.blog/",
        breaks: true,
        skipSanitization: false,
        allowInsecureScriptTags: false,
        addNofollowToLinks: true,
        doNotShowImages: false,
        ipfsPrefix: "",
        assetsWidth: 640,
        assetsHeight: 480,
        imageProxyFn: (url) => url,
        usertagUrlFn: (account) => "/@holger80",
        hashtagUrlFn: (hashtag) => "/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed",
        isLinkSafeFn: (url) => true,
      });
      
      const inputElem = $('#content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed').html();
      const outputElem = $('#content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed');
      const output = renderer.render(inputElem);
      
      outputElem.html(output);
    } catch(e) {
      console.log(e);
    }
  });
</script>
<style>
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed {
    padding: 0 3rem;
    color: #444444;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 1.8;
    text-shadow: 0 1px 0 #ffffff;
    padding: 0.5rem;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed code {
    background: white;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed a {
    border-bottom: 1px solid #444444; color: #444444; text-decoration: none;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed a:hover {
    border-bottom: 0;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed h1 {
    font-size: 2.2em;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed h2, h3, h4, h5 {
    margin-bottom: 0;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed header small {
    color: #999;
    font-size: 50%;
  }
  #content-holger80-how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed img {
    max-width: 100%;
  }
</style>

<hr />
<p>
  See: <a href="https://hive.blog/hive-139531/@holger80/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed">How to use a coldcard MK3 to derive your new account password from a 24 word seed</a>
  by
  <a href="https://hive.blog/@holger80">@holger80</a>
</p>

</username></div>

  </div><a class="u-url" href="/news/python/wallet/2020/12/05/how-to-use-a-coldcard-mk3-to-derive-your-new-account-password-from-a-24-word-seed.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><a rel="author" href="/">Hive Chain Documentation</a></h2>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">site curated by: @inertia</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Your resource for various levels of Hive Documentation.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
