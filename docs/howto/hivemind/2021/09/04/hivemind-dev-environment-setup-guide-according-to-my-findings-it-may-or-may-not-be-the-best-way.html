<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/assets/images/sticker.png" />
  <meta name="apple-mobile-web-app-title" content="Hive Docs" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hivemind dev environment setup guide (according to my findings, it may or may not be the best way) | Hive Chain Documentation</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Hivemind dev environment setup guide (according to my findings, it may or may not be the best way)" />
<meta name="author" content="howo" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Setting up a dev environment can be a bit tricky so I figured I’d share a bit of the knowledge I got while doing it." />
<meta property="og:description" content="Setting up a dev environment can be a bit tricky so I figured I’d share a bit of the knowledge I got while doing it." />
<link rel="canonical" href="https://peakd.com/hivemind/@howo/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way" />
<meta property="og:url" content="https://peakd.com/hivemind/@howo/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way" />
<meta property="og:site_name" content="Hive Chain Documentation" />
<meta property="og:image" content="https://files.peakd.com/file/peakd-hive/howo/23tbHAEfLVug1GpxE6vi5LhibWoQ88SeqNsKWio9vGeEWtPtw8EgBzsGQxkkKVdT7pj6v.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-04T02:41:03-07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://files.peakd.com/file/peakd-hive/howo/23tbHAEfLVug1GpxE6vi5LhibWoQ88SeqNsKWio9vGeEWtPtw8EgBzsGQxkkKVdT7pj6v.png" />
<meta property="twitter:title" content="Hivemind dev environment setup guide (according to my findings, it may or may not be the best way)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"howo"},"dateModified":"2021-09-04T02:41:03-07:00","datePublished":"2021-09-04T02:41:03-07:00","description":"Setting up a dev environment can be a bit tricky so I figured I’d share a bit of the knowledge I got while doing it.","headline":"Hivemind dev environment setup guide (according to my findings, it may or may not be the best way)","image":"https://files.peakd.com/file/peakd-hive/howo/23tbHAEfLVug1GpxE6vi5LhibWoQ88SeqNsKWio9vGeEWtPtw8EgBzsGQxkkKVdT7pj6v.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://peakd.com/hivemind/@howo/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way"},"url":"https://peakd.com/hivemind/@howo/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://hivedocs.info/feed.xml" title="Hive Chain Documentation" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-161692811-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  
  <!-- jQuery Modal -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" integrity="sha256-iM4Yzi/zLj/IshPWMC1IluRxTtRjMqjPGd97TZ9yYpU=" crossorigin="anonymous"></script>
  <script src='https://unpkg.com/steem-content-renderer'></script>
  <script>
    (function () {
      if (Turbolinks.supported) {
        Turbolinks.setProgressBarDelay(500);
      }
    })();
  </script>
  <script src="/assets/javascript/universal-bridge-against-phishing.js"></script>
  <script src="/assets/javascript/lazysizes.min.js" async=""></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Cousine|Inconsolata" rel="stylesheet" />
  <link rel="shortcut icon" type="image/png" href="/assets/images/favicon-80x80.png" />
  <link rel="apple-touch-icon" type="image/png" href="/assets/images/favicon-80x80.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicon-80x80.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon-80x80.png" />
  <link rel="apple-touch-icon" sizes="167x167" href="/assets/images/favicon-80x80.png" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Hive Chain Documentation</a>

      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/news/">News</a><a class="page-link" href="/howto/">How To</a><a class="page-link" href="/links/">Useful Links</a><a class="page-link" href="/authors/">Authors</a><!-- HTML elements for search -->
          <input type="text" id="search-input" placeholder="Search" />
          
          <ul id="results-container"></ul>

          <script src="/assets/javascript/search.js"></script>
          <script>
            var sjs = SimpleJekyllSearch({
              searchInput: document.getElementById('search-input'),
              resultsContainer: document.getElementById('results-container'),
              json: '/search.json'
            })
          </script>
          <!-- <form style="float: right;" class="form-inline" method="get" action="http://www.google.com/search">
            <input type="hidden" name="sitesearch" value="hivedocs.info" />
            <input type="text" name="q" maxlength="255" placeholder="Search" />
          </form> -->
          
          <!-- <a href="#" onclick="try { $('#authors-container').slideToggle(); } catch { document.getElementById('authors-container').style.display = 'block'; }; return false;">Authors &#187;</a>
          <a href="#" onclick="try { $('#topics-container').slideToggle(); } catch { document.getElementById('topics-container').style.display = 'block'; }; return false;">Topics &#187;</a> -->
          
          <a href="#topics-container" rel="modal:open">Topics &#187;</a>
          
          <div id="topics-container" class="modal">
            <h3>Topics</h3>
            <ul><li><a class="page-link" href="/account-recovery/"><nobr>Account Recovery</nobr></a></li><li><a class="page-link" href="/core-development/"><nobr>Core Development</nobr></a></li><li><a class="page-link" href="/dapps/"><nobr>Dapps</nobr></a></li><li><a class="page-link" href="/docker/"><nobr>Docker</nobr></a></li><li><a class="page-link" href="/hardfork/"><nobr>Hardfork</nobr></a></li><li><a class="page-link" href="/hivemind/"><nobr>Hivemind</nobr></a></li><li><a class="page-link" href="/javascript/"><nobr>Javascript</nobr></a></li><li><a class="page-link" href="/multisig/"><nobr>Multisig</nobr></a></li><li><a class="page-link" href="/python/"><nobr>Python</nobr></a></li><li><a class="page-link" href="/ruby/"><nobr>Ruby</nobr></a></li><li><a class="page-link" href="/testnet/"><nobr>Testnet</nobr></a></li><li><a class="page-link" href="/tools/"><nobr>Tools</nobr></a></li><li><a class="page-link" href="/witness/"><nobr>Witness</nobr></a></li></ul>
          </div>
        </div>
      </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <div class="pull-right well">
      <img src="https://images.hive.blog/u/howo/avatar" width="128" height="128" class="lazyload" />
    </div>
    
    <h1 class="post-title p-name" itemprop="name headline">Hivemind dev environment setup guide (according to my findings, it may or may not be the best way)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-09-04T02:41:03-07:00" itemprop="datePublished">Sep 4, 2021
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">
          <a href="/authors/#author-howo">howo</a>
        </span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div id="content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way">
![image.png](https://files.peakd.com/file/peakd-hive/howo/23tbHAEfLVug1GpxE6vi5LhibWoQ88SeqNsKWio9vGeEWtPtw8EgBzsGQxkkKVdT7pj6v.png)


Hello !

As some of you may know, I am working on hivemind (wohoo communities v2 coming soon:tm:)
Setting up a dev environment can be a bit tricky so I figured I'd share a bit of the knowledge I got while doing it. 

For the record it's what I found, it may not be the best way to do it, if you know ways to improve it please comment below :)

# Postgresql

First we need a postgres database, I think docker is best here because it allows us to have exactly the version we want, and not struggle installing it. 

you will need to install docker and docker compose.

one you have that create a docker-compose.yml file with this content

```
version: '3'
services:
    dbpostgres:
        image: postgres:11
        container_name: hivemind-postgres-dev-container
        ports:
            - "5532:5432"
        environment:
            - POSTGRES_DB=hive
            - POSTGRES_PASSWORD=root
```

Then in the directory run 
`docker compose up -d `


then connect to it using your favorite tool (I use datagrip) and install the intarray extension: (you could improve this with a post install script with the dockerfile but I didnt' have the motivation to do it for now)

`CREATE EXTENSION IF NOT EXISTS intarray;`


# Hive setup:

(if hive got another update check https://gtg.openhive.network/get/bin/)
(it's better to build hived yourself but we can assume @gtg is trustworthy)
`wget https://gtg.openhive.network/get/bin/hived-v1.25.0`
``mv hived-v1.25.0 hived &amp;&amp; chmod +x hived``
``mkdir data``

execute hived for two seconds to create the directory structure

`./hived -d data`
then exit and delete the blockchain files 
`rm -rf ./data/blockchain/*`
then we'll download the first 5 million block_log from gtg and put it on the right directory
`wget https://gtg.openhive.network/get/blockchain/block_log.5M -P data/blockchain/ &amp;&amp; mv data/blockchain/block_log.5M block_log`
 
then update the hived config.ini:

nano data/config.ini
```
log-appender = {"appender":"stderr","stream":"std_error"}
log-logger = {"name":"default","level":"info","appender":"stderr"}
backtrace = yes
plugin = webserver p2p json_rpc
plugin = database_api
# condenser_api enabled per abw request
plugin = condenser_api
plugin = block_api
# gandalf enabled witness + rc
plugin = witness
plugin = rc

# market_history enabled per abw request
plugin = market_history
plugin = market_history_api

plugin = account_history_rocksdb
plugin = account_history_api

# gandalf enabled transaction status
plugin = transaction_status
plugin = transaction_status_api

# gandalf enabled account by key
plugin = account_by_key
plugin = account_by_key_api

# and few apis
plugin = block_api network_broadcast_api rc_api

history-disable-pruning = 1
account-history-rocksdb-path = "blockchain/account-history-rocksdb-storage"

# shared-file-dir = "/run/hive"
shared-file-size = 20G
shared-file-full-threshold = 9500
shared-file-scale-rate = 1000

flush-state-interval = 0

market-history-bucket-size = [15,60,300,3600,86400]
market-history-buckets-per-size = 5760

p2p-endpoint = 0.0.0.0:2001
p2p-seed-node =
# gtg.openhive.network:2001

transaction-status-block-depth = 64000
transaction-status-track-after-block = 42000000

webserver-http-endpoint = 0.0.0.0:8091
webserver-ws-endpoint = 0.0.0.0:8090

webserver-thread-pool-size = 8
```
finally replay your node, and stop at 5 million blocks

`./hived --replay-blockchain --stop-replay-at-block 5000000 -d data
`
this will cook for 10-20 minutes depending on your hardware


# Hivemind setup

First, clone hivemind
`git clone git@gitlab.syncad.com:hive/hivemind.git`
then switch to the develop branch (usually better for...developping)
`git checkout develop`
and then install the dependencies
`python3 -m pip install --no-cache-dir --verbose --user -e .[dev] 2&gt;&amp;1 | tee pip_install.log`

Then if your hived node is done replaying, you can do your first sync:

`./cli.py --database-url postgresql://postgres:root@localhost:5532/hive --test-max-block=4999998 --steemd-url={"default":"http://localhost:8091"}`

this process will take quite a bit ( ~20 minutes or more depending on your hardware)

Then what I like to do is dump the database so I can get back to this state easily without having to resync everything:

`PGPASSWORD=root  pg_dump -h localhost -p 5532 -U postgres -d hive -f dump.dump -format=custom`

and if I want to restore:

`PGPASSWORD=root pg_restore -h localhost -p 5532 -U postgres -d hive  dump.dump -j12 --clean`

Finally if you want to test some specific applications, mocks are your friends ! look into the `mock_data` folder for examples.

In order to do a sync and add the mock data you can do this:

`./cli.py --database-url postgresql://postgres:root@localhost:5532/hive --test-max-block=4999998 --steemd-url={"default":"http://localhost:8091"}  --mock-block-data-path /home/howo/projects/hivemind/mock_data/block_data/community_op/mock_block_data_community_test.json` (replace the path with whatever mock file you have obviously)

Slight note on  --test-max-block, it needs to be the height of the highest block of your mocks + 2, because hivemind trails the real blockchain by two blocks, so if you set  --test-max-block as 2 and your mocks end at block 2, they won't be picked up. </div>
<script crossorigin="anonymous" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>

<script src="https://unpkg.com/steem-content-renderer"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/hive-content-renderer/dist/hive-content-renderer.min.js"></script> -->
<script>
  $(document).ready(function() {
    try {
      const renderer = new SteemContentRenderer.DefaultRenderer({
      // const renderer = new HiveContentRenderer({
        baseUrl: "https://hive.blog/",
        breaks: true,
        skipSanitization: false,
        allowInsecureScriptTags: false,
        addNofollowToLinks: true,
        doNotShowImages: false,
        ipfsPrefix: "",
        assetsWidth: 640,
        assetsHeight: 480,
        imageProxyFn: (url) => url,
        usertagUrlFn: (account) => "/@howo",
        hashtagUrlFn: (hashtag) => "/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way",
        isLinkSafeFn: (url) => true,
      });
      
      const inputElem = $('#content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way').html();
      const outputElem = $('#content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way');
      const output = renderer.render(inputElem);
      
      outputElem.html(output);
    } catch(e) {
      console.log(e);
    }
  });
</script>

<style>
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way {
    padding: 0 3rem;
    color: #444444;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 1.8;
    text-shadow: 0 1px 0 #ffffff;
    padding: 0.5rem;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way code {
    background: white;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way a {
    border-bottom: 1px solid #444444; color: #444444; text-decoration: none;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way a:hover {
    border-bottom: 0;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way h1 {
    font-size: 2.2em;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way h2, h3, h4, h5 {
    margin-bottom: 0;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way header small {
    color: #999;
    font-size: 50%;
  }
  #content-howo-hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way img {
    max-width: 100%;
  }
</style>

<hr />

<p>
  See: <a href="https://peakd.com/hivemind/@howo/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way">Hivemind dev environment setup guide (according to my findings, it may or may not be the best way)</a>
  by
  <a href="https://hive.blog/@howo">@howo</a>
</p>


  </div><a class="u-url" href="/howto/hivemind/2021/09/04/hivemind-dev-environment-setup-guide-according-to-my-findings-it-may-or-may-not-be-the-best-way.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><a rel="author" href="/">Hive Chain Documentation</a></h2>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">site curated by: @inertia</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Your resource for various levels of Hive Documentation.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
