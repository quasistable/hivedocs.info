<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How to set up a Hive Witness or Seed node (non-MIRA) / Upgrade from Steem-Docker to Hive-Docker | Hive Chain Documentation</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="How to set up a Hive Witness or Seed node (non-MIRA) / Upgrade from Steem-Docker to Hive-Docker" />
<meta name="author" content="someguy123" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this post you’ll learn how to setup a Hive witness, or upgrade from Steem-docker" />
<meta property="og:description" content="In this post you’ll learn how to setup a Hive witness, or upgrade from Steem-docker" />
<link rel="canonical" href="https://peakd.com/hive-139531/@someguy123/how-to-set-up-a-hive-witness-or-seed-node-non-mira-upgrade-from-steem-docker-to-hive-docker" />
<meta property="og:url" content="https://peakd.com/hive-139531/@someguy123/how-to-set-up-a-hive-witness-or-seed-node-non-mira-upgrade-from-steem-docker-to-hive-docker" />
<meta property="og:site_name" content="Hive Chain Documentation" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-27T12:30:21-07:00" />
<script type="application/ld+json">
{"description":"In this post you’ll learn how to setup a Hive witness, or upgrade from Steem-docker","headline":"How to set up a Hive Witness or Seed node (non-MIRA) / Upgrade from Steem-Docker to Hive-Docker","dateModified":"2020-04-27T12:30:21-07:00","datePublished":"2020-04-27T12:30:21-07:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://peakd.com/hive-139531/@someguy123/how-to-set-up-a-hive-witness-or-seed-node-non-mira-upgrade-from-steem-docker-to-hive-docker"},"url":"https://peakd.com/hive-139531/@someguy123/how-to-set-up-a-hive-witness-or-seed-node-non-mira-upgrade-from-steem-docker-to-hive-docker","author":{"@type":"Person","name":"someguy123"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://hivedocs.info/feed.xml" title="Hive Chain Documentation" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-161692811-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" integrity="sha256-iM4Yzi/zLj/IshPWMC1IluRxTtRjMqjPGd97TZ9yYpU=" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Cousine|Inconsolata" rel="stylesheet">
  <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png">
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Hive Chain Documentation</a>

      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/news/">News</a><a class="page-link" href="/howto/">How To</a><a class="page-link" href="/links/">Useful Links</a><!-- HTML elements for search -->
          <input type="text" id="search-input" placeholder="Search" />
          
          <ul id="results-container"></ul>

          <script src="/assets/javascript/search.js"></script>
          <script>
            var sjs = SimpleJekyllSearch({
              searchInput: document.getElementById('search-input'),
              resultsContainer: document.getElementById('results-container'),
              json: '/search.json'
            })
          </script>
          <!-- <form style="float: right;" class="form-inline" method="get" action="http://www.google.com/search">
            <input type="hidden" name="sitesearch" value="hivedocs.info" />
            <input type="text" name="q" maxlength="255" placeholder="Search" />
          </form> -->
        </div>
      </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to set up a Hive Witness or Seed node (non-MIRA) / Upgrade from Steem-Docker to Hive-Docker</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-04-27T12:30:21-07:00" itemprop="datePublished">Apr 27, 2020
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">
          <a href="https://hive.blog/@someguy123">someguy123</a>
        </span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    
<div style="display: block; margin: 0 auto;">

  <p><img src="https://cdn.privex.io/img/posts/hive-in-a-box.png" alt="Hive-in-a-box Logo" /></p>

</div>

<h1 id="fresh-install">Fresh install</h1>

<p>To become a witness without using MIRA, you’ll require a server with at LEAST 64GB of RAM, 500GB disk (preferably SSD / NVMe), and a fast, reliable network.</p>

<p>If you do not have a server which meets these requirements, you can order one from <a href="privex.io">Privex</a> (you can even pay with HIVE/HBD!)</p>

<p>I personally use @privex for my own witness as a Top 20. While I am the CEO of Privex, there are many other customers, including witnesses who use our servers for their witness nodes, seed nodes, RPC nodes and/or other projects.</p>

<p>You’re free to use any other server provider. I don’t recommend trying to run a witness on your home internet, as it’s likely not reliable enough for a witness.</p>

<p>Be aware that certain server providers have poor networks or hardware, which may cause missed blocks, so you may be hopping around a few until you can find one that’s suitable for a witness node.</p>

<p>If you want to learn more about witnesses and what they do, check out my article: <a href="https://peakd.com/witness-category/@someguy123/seriously-what-is-a-witness-why-should-i-care-how-do-i-become-one-answer">here</a></p>

<h3 id="shared-memory-note">Shared memory note</h3>

<p>Right now, the minimum RAM requirement for non-MIRA witnesses is 64GB due to shared memory.</p>

<p>This is because Hive stores information in a file called “shared_memory.bin” which is used similar to RAM. This file is around 58GB on HF23, and will continue to grow overtime.</p>

<p>As this file continues to grow, you will need to increase the amount of RAM in your server. So it is better to have some room.</p>

<h3 id="install-hive-docker-and-dependencies">Install hive-docker and dependencies</h3>

<p>First, we install some basic dependencies (assuming you’re on Ubuntu/Debian).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt update
sudo apt install git curl wget
</code></pre></div></div>

<p>Next, we install hive-docker (a line starting with a # is a comment, you don’t need to paste them)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone 
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">"https://github.com/someguy123/hive-docker.git"</span><span class="o">&gt;</span>https://github.com/someguy123/hive-docker.git&lt;/a&gt;

<span class="nb">cd </span>hive-docker
<span class="c"># If you don't already have a docker installation, this will install it for you</span>
./run.sh install_docker
</code></pre></div></div>

<p>After the install_docker command has finished, it’s recommended to log out and back in again (e.g. close your SSH client and re-connect) to ensure that the shell correctly detects docker.</p>

<p>Then, you can download and install the latest witness/seed docker image</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># This downloads/updates the low-memory docker image for Hive
./run.sh install
</code></pre></div></div>

<p>If you are a witness, you need to adjust the configuration as needed e.g. witness name, private key, logging config, turn off p2p-endpoint etc.</p>

<p>If you’re running a seed, then don’t worry about the config, it will just work and you can skip the signing key/config section</p>

<h3 id="generating-a-signing-key">Generating a signing key</h3>

<p>For witnesses, you’ll need to generate a signing key first. You can use the remote wallet for this.</p>

<p>Open the wallet using a public server with the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh remote_wallet
</code></pre></div></div>

<p><strong>Note: you may receive an error such as “timeout” or “invalid http status”. This is normal, it’s usually due to a server in the Privex load balancer having temporary problems.</strong></p>

<p><strong>Just run the command again a few times until it connects (you’ll see new»&gt; or locked»&gt;)</strong></p>

<p>Create a key pair for your witness.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suggest_brain_key
</code></pre></div></div>

<div style="display: block; margin: 0 auto;">

  <p><img src="https://cdn.privex.io/img/posts/hive-suggest-brainkey.png" alt="Screenshot of cli_wallet suggest_brain_key command" /></p>

</div>

<p>You should get something similar to this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "brain_priv_key": "GOCART VINCENT PHOTIC IRON OUTHIT UNGLOBE SICCA LOP TASKIT BOOSTER WINDED SPRY SACKBUT UNICE WELL RUBELLE",
  "wif_priv_key": "5J1Wn41BbSS4L83N9n7P5nmMSVg9uaWfVySnd363TvyhWPzU2e9",
  "pub_key": "STM7iCEkCR261F7CeBCsmpE1RcW8hnR5pZYKCFbuVqe5HSJ41YewE"
}
</code></pre></div></div>

<p><strong>Put the keys in Notepad or something similar for the moment so you don’t lose them.</strong></p>

<p>Press CTRL-D to exit the wallet.</p>

<h3 id="setting-up-your-config">Setting up your config</h3>

<p>Now, to set your witness name and private key. You can use <code class="highlighter-rouge">nano</code> (a simple text editor on Linux) for this.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nano data/witness_node_data_dir/config.ini
</code></pre></div></div>

<p>If you are running a witness, you’ll want to change one of the first lines in the file to disable the seed.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Endpoint for P2P node to listen on
p2p-endpoint = 0.0.0.0:2001
</code></pre></div></div>

<p>Simply place a # (hash sign) at the start of the p2p-endpoint line. This will disable the seed. Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Endpoint for P2P node to listen on
#p2p-endpoint = 0.0.0.0:2001
</code></pre></div></div>

<p>Now to add your witness settings. Scroll down the file (use the up/down arrows, or page up/down) until you see something like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Percent of witnesses (0-99) that must be participating in order to produce blocks
required-participation = 33

# name of witness controlled by this node (e.g. initwitness )
# witness =

# name of miner and its private key (e.g. ["account","WIF PRIVATE KEY"] )
# miner =

# Number of threads to use for proof of work mining
# mining-threads =

# WIF PRIVATE KEY to be used by one or more witnesses or miners
# private-key =
</code></pre></div></div>

<div style="display: block; margin: 0 auto;">

  <p><img src="https://cdn.privex.io/img/posts/hive-witness-config.png" alt="Screenshot of witness config.ini" /></p>

</div>

<p>You’ll want to uncomment (remove the # from the start) the <code class="highlighter-rouge">witness =</code> line, and the <code class="highlighter-rouge">private-key =</code> line.</p>

<p>Grab your public/private key that you saved earlier into notepad (or other similar app).</p>

<p>Then, similar to below, add your witness’ name in quotes, e.g. “someguy123” in front of the <code class="highlighter-rouge">witness =</code>, and your private key (without quotes) in front of the <code class="highlighter-rouge">private-key =</code> line. To save you time in the future, it can be useful to place your public signing key in a comment above your private key (see example)</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># name of witness controlled by this node (e.g. initwitness )
witness = "someguy123"

# name of miner and its private key (e.g. ["account","WIF PRIVATE KEY"] )
# miner =

# Number of threads to use for proof of work mining
# mining-threads =

# WIF PRIVATE KEY to be used by one or more witnesses or miners
# public key: STM7iCEkCR261F7CeBCsmpE1RcW8hnR5pZYKCFbuVqe5HSJ41YewE
private-key = 5J1Wn41BbSS4L83N9n7P5nmMSVg9uaWfVySnd363TvyhWPzU2e9
</code></pre></div></div>

<p>Now (assuming you’re using nano) press CTRL-X, and press the y key when it asks if you would like to save.</p>

<h3 id="environment-settings">Environment settings</h3>

<p>If you’re already comfortable with Linux, and want to play around with settings for hive-docker you may want to consider setting up a .env file, see the <a href="https://github.com/someguy123/hive-docker">README for more information</a></p>

<p>Otherwise, let’s continue. The defaults are generally fine for most people.</p>

<h3 id="setting-up-shared-memory-swap-settings-and-downloading-the-blockchain">Setting up shared memory, swap settings, and downloading the blockchain</h3>

<p>At this point you should have:</p>

<ul>
  <li>installed hive-in-a-box</li>
  <li>installed docker (through the run.sh command)</li>
  <li>downloaded and installed the Hive docker container</li>
  <li>set up your witness configuration</li>
</ul>

<p>Your witness is almost ready. Just a few more small things.</p>

<p>You’ll need to set the shared memory size (use sudo if not logged in as root). 64 gigabytes is recommended (64G). Please be aware that the shared memory size changes constantly.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo ./run.sh shm_size 64G
</code></pre></div></div>

<p>You’ll also want to adjust your “swappiness”. This is a setting which tells Linux how much it should use swap (virtual memory on your disk. very slow). You’ll want to set this to 1, which means “don’t use the swap unless it’s absolutely necessary”. This helps to prevent missed blocks due to excessive swapping despite plenty of free RAM.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># To persist on reboot, place 'vm.swappiness=1' in /etc/sysctl.conf
sudo sysctl -w vm.swappiness=1
</code></pre></div></div>

<p>Now that you’ve configured your server, it’s recommended to download the block log, as replays can be faster than p2p download.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh dlblocks
</code></pre></div></div>

<p><img src="https://cdn.privex.io/img/posts/hive-dlblocks.png" alt="Screenshot of run.sh dlblocks command" /></p>

<h3 id="almost-ready">Almost ready!</h3>

<p>Once this is done, you should be ready to start your server. The <code class="highlighter-rouge">replay</code> command will start <code class="highlighter-rouge">steemd</code> (the binary is still called <code class="highlighter-rouge">steemd</code> for Hive) in docker, and begin replaying the blockchain which was downloaded to create a block index, and the shared_memory file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh replay
</code></pre></div></div>

<p>You can check the status with the <code class="highlighter-rouge">logs</code> command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh logs
</code></pre></div></div>

<p>Assuming you did everything correctly, you should see something like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>------------------------------------------------------

            STARTING HIVE NETWORK

------------------------------------------------------
initminer public key: STM8GC13uCZbP44HzMLV6zPZGwVQ8Nt4Kji8PapsPiNq1BK153XTX
chain id: 0000000000000000000000000000000000000000000000000000000000000000
blockchain version: 0.23.0
------------------------------------------------------
2393837ms main.cpp:121                  main                 ] Backtrace on segfault is enabled.
2393837ms chain_plugin.cpp:405          plugin_startup       ] Starting chain with shared_file_size: 53687091200 bytes
2393837ms chain_plugin.cpp:483          plugin_startup       ] Replaying blockchain on user request.
2393837ms database.cpp:185              reindex              ] Reindexing Blockchain
2396435ms block_log.cpp:142             open                 ] Log is nonempty
2396435ms block_log.cpp:151             open                 ] Index is nonempty
2396435ms database.cpp:193              reindex              ] Replaying blocks...
</code></pre></div></div>

<p>Please be aware that this can take many hours depending on your disk speed and CPU. In some cases it can take up to 24 hours.</p>

<p>You can press CTRL-C to exit the logs, or just leave it if you want to watch it replay.</p>

<h3 id="after-youve-replayed">After you’ve replayed</h3>

<p>Once you see something which looks like this, it means your server is now ready to go:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1299055ms th_a       application.cpp:507           handle_block         ] Got 14 transactions on block 12928269 by pharesim -- latency: 55 ms
1302427ms th_a       application.cpp:507           handle_block         ] Got 18 transactions on block 12928270 by xeldal -- latency: 426 ms
1305291ms th_a       application.cpp:507           handle_block         ] Got 26 transactions on block 12928271 by arhag -- latency: 291 ms
1308045ms th_a       application.cpp:507           handle_block         ] Got 20 transactions on block 12928272 by pfunk -- latency: 45 ms
1311092ms th_a       application.cpp:507           handle_block         ] Got 23 transactions on block 12928273 by bhuz -- latency: 92 ms
</code></pre></div></div>

<p>Go to your profile:</p>

<ul>
  <li>
    <p><a href="https://wallet.hive.blog/@yourusername/permissions">https://wallet.hive.blog/@yourusername/permissions</a></p>
  </li>
  <li>
    <p><a href="https://peakd.com/@yourusername/permissions">https://peakd.com/@yourusername/permissions</a></p>
  </li>
  <li>
    <p>(for the links, you need to edit the @yourusername part)</p>
  </li>
</ul>

<p>Click Wallet, then Permissions. Next to “Active Key” you should see “Reveal”. Click that button and log in. Then press “Show private key”, to reveal it. Make sure it begins with a “5”.</p>

<p>Copy the key.</p>

<p>Now open the wallet with:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh wallet
</code></pre></div></div>

<p><img src="https://cdn.privex.io/img/posts/hive-wallet-activekey.png" alt="Screenshot of Hive Wallet active key page" /></p>

<p>Set a password, unlock the wallet with the same password, then import your ACTIVE private key from wallet.hive.blog / Peakd (NOT the one in notepad):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set_password "hunter2"
unlock "hunter2"
import_key 5somethingprivatekey
</code></pre></div></div>

<p>Finally, we can update/create the witness on the network. Replace the STMxxxx key with the public key you saved earlier in notepad (or if you wrote it as a comment in your config file, you can open that and get it from there), and replace YOURNAME with your witness name on Hive.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>update_witness "YOURNAME" "https://hive.blog/witness-category/@YOURNAME/my-witness-thread" "STMxxxxxxx" {"account_creation_fee":"3.000 HIVE","maximum_block_size":65536,"sbd_interest_rate":0} true
</code></pre></div></div>

<h1 id="congratulations-your-witness-should-now-be-working-and-you-can-begin-getting-votes-and-producing-blocks">Congratulations, your witness should now be working, and you can begin getting votes and producing blocks</h1>

<h3 id="other-useful-information">Other useful information</h3>

<p>You may want to persist the /dev/shm size (shared memory) across reboots. To do this, you can edit <code class="highlighter-rouge">/etc/fstab</code>, please be very careful, as any mistakes in this file will cause your system to become unbootable. (<strong>if you are not comfortable with linux, please don’t try this as you may break your server</strong>).</p>

<p>Simply add this to the bottom of the file on a new line. Be sure not to damage any other lines in the file. Adjust “64G” to whatever size you would like /dev/shm to be.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tmpfs   /dev/shm         tmpfs   nodev,nosuid,size=64G          0  0
</code></pre></div></div>

<p>See <a href="https://github.com/someguy123/hive-docker">the README</a> for more advanced options.</p>

<h1 id="upgrading-steem-docker-to-hive-docker">Upgrading steem-docker to hive-docker</h1>

<p>If you have an existing <code class="highlighter-rouge">steem-docker</code> installation, you can convert it into a <code class="highlighter-rouge">hive-docker</code> installation by following the below steps.</p>

<h2 id="updating-your-git-repository">Updating your Git repository</h2>

<p>Use <code class="highlighter-rouge">git remote set-url</code> to change your steem-docker installation to track my <code class="highlighter-rouge">hive-docker</code> repository. Then <code class="highlighter-rouge">git fetch</code> to download any updates, checkout master, and <code class="highlighter-rouge">git pull</code> to update to <code class="highlighter-rouge">hive-docker</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
~/steem-docker $ git remote set-url origin 
&lt;a href="https://github.com/Someguy123/hive-docker.git"&gt;https://github.com/Someguy123/hive-docker.git&lt;/a&gt;

~/steem-docker $ git fetch
~/steem-docker $ git checkout master
~/steem-docker $ git pull
</code></pre></div></div>

<p>To ensure <code class="highlighter-rouge">hive-docker</code> always uses the Hive network, add <code class="highlighter-rouge">NETWORK=hive</code> to your <code class="highlighter-rouge">.env</code> file</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nb">echo</span> <span class="s2">"NETWORK=hive"</span> <span class="o">&gt;&gt;</span> .env

</code></pre></div></div>

<p>Download the Hive HF23 docker image using this command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh install
</code></pre></div></div>

<h2 id="if-you-were-previously-running-steem-youll-need-to-replace-your-blockchain-and-state-files">If you were previously running Steem, you’ll need to replace your blockchain and state files</h2>

<p>Delete your blockchain files and shared memory files using the <code class="highlighter-rouge">clean</code> command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh clean
</code></pre></div></div>

<p><img src="https://cdn.privex.io/img/posts/hive-clean.png" alt="Screenshot of run.sh clean command" /></p>

<p>Download a fresh block_log:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh dlblocks
</code></pre></div></div>

<p><img src="https://cdn.privex.io/img/posts/hive-dlblocks.png" alt="Screenshot of run.sh dlblocks command" /></p>

<h3 id="now-for-the-slow-part---replaying">Now for the slow part - replaying</h3>

<p>When upgrading from Steem to Hive, you’ll need to replay.</p>

<p>To replay your witness, do the following (this will shutdown and remove the Steem software, and start a Hive one in replay mode)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh stop
./run.sh replay
</code></pre></div></div>

<p>You can check the status of the replay with the logs command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./run.sh logs
</code></pre></div></div>

<p>Note: the command now automatically updates in realtime. to exit the logs press CTRL-C</p>

<p>If all is well, you’ll see it replaying on v0.23.0 (or whatever version is out by the time you read this):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>------------------------------------------------------

            STARTING HIVE NETWORK

------------------------------------------------------
initminer public key: STM8GC13uCZbP44HzMLV6zPZGwVQ8Nt4Kji8PapsPiNq1BK153XTX
chain id: 0000000000000000000000000000000000000000000000000000000000000000
blockchain version: 0.23.0
------------------------------------------------------
2393837ms main.cpp:121                  main                 ] Backtrace on segfault is enabled.
2393837ms chain_plugin.cpp:405          plugin_startup       ] Starting chain with shared_file_size: 53687091200 bytes
2393837ms chain_plugin.cpp:483          plugin_startup       ] Replaying blockchain on user request.
2393837ms database.cpp:185              reindex              ] Reindexing Blockchain
2396435ms block_log.cpp:142             open                 ] Log is nonempty
2396435ms block_log.cpp:151             open                 ] Index is nonempty
2396435ms database.cpp:193              reindex              ] Replaying blocks...
</code></pre></div></div>

<p>Once it’s replayed (may take 3 or more hours), you’ll see the standard “got x transactions on block y”.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1668107ms p2p_plugin.cpp:210            handle_block         ] Got 54 transactions on block 25299003 by cervantes -- latency: 107 ms
1671090ms p2p_plugin.cpp:210            handle_block         ] Got 36 transactions on block 25299004 by blocktrades -- latency: 90 ms
1674098ms p2p_plugin.cpp:210            handle_block         ] Got 28 transactions on block 25299005 by roelandp -- latency: 98 ms
</code></pre></div></div>

<p>If you see this, you can now re-enable this server :)</p>

<p>You’re successfully upgraded to 0.23.0 (or higher).</p>

<p>For future HF23 releases, it will now be as simple as <code class="highlighter-rouge">./run.sh install &amp;&amp; ./run.sh restart</code>, but as always, be careful, always assume a replay may be needed. Test on your backup, or disable your witness before attempting to update.</p>

<p>To see if I’ve released a new version of the docker image and haven’t made a post yet, just check my docker hub: 
<a href="https://hub.docker.com/r/someguy123/hive/tags/">https://hub.docker.com/r/someguy123/hive/tags/</a></p>

<hr />

<div style="display: block; margin: 0 auto;">

  <p><img src="https://i.giphy.com/media/l378lvuErndt84HII/giphy.gif" alt="" /></p>

</div>

<p>GIF Avatar by @stellabelle</p>

<hr />

<h3 id="do-you-like-what-im-doing-for-hive">Do you like what I’m doing for Hive?</h3>

<p><a href="https://wallet.hive.blog/~witnesses">Vote for me to be a witness</a> - every vote counts.</p>

<h3 id="dont-forget-to-follow-me-for-more-like-this">Don’t forget to follow me for more like this.</h3>

<hr />

<p>Are you looking for a new server provider? My company @privex offers highly-reliable and affordable dedicated and virtual servers for HIVE, HBD, EOS, Monero, DOGE, LTC, and BTC!</p>

<p>Check out our website at 
<a href="https://www.privex.io">https://www.privex.io</a></p>

<p>Join the Privex discord at: 
<a href="https://invite.gg/privex">https://invite.gg/privex</a></p>

<hr />

<hr />

<p>
  See: <a href="https://peakd.com/hive-139531/@someguy123/how-to-set-up-a-hive-witness-or-seed-node-non-mira-upgrade-from-steem-docker-to-hive-docker">How to set up a Hive Witness or Seed node (non-MIRA) / Upgrade from Steem-Docker to Hive-Docker</a>
  by
  <a href="https://hive.blog/@someguy123">@someguy123</a>
</p>


  </div><a class="u-url" href="/howto/witness/docker/node/2020/04/27/how-to-set-up-a-hive-witness-or-seed-node-non-mira-upgrade-from-steem-docker-to-hive-docker.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><a rel="author" href="/">Hive Chain Documentation</a></h2>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">site curated by: @inertia</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Your resource for various levels of Hive Documentation.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
